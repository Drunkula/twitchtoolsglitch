<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Speecher Test</title>
	<script src="Speecher.class.js" ></script>
</head>
<body>
	Speecher Tester
	<div id="mainoutput">

	</div>

	<button onclick="say_something()">Speek</button>
	<button onclick="ss.cancel()">Cancel</button>
	<button onclick="ss.reset()">Reset</button>
	<button onclick="ss.pause()">Pause</button>
	<button onclick="ss.resume()">Resume</button>
</body>
</html>
<script>

out("SPEECHER CLASS Ready")
let ss = new Speecher();

ss.on({
		//boundary: (e) => {console.log("  ############### on boundary", e);},
		start: (e) => {console.log("  ########## on start", e);},
		end: (e) => { console.log("  ########### on end", e); out("End event")},
		error: e => { out("Error : ", e.error); }
	});

ss.addEventListener('voiceschanged', () => { out("The voices changed, oooo") })

var voices;

const say_something = async () => {
	console.log( "Voices", ss.getVoices() );

	await ss.ready();

	voices = ss.getVoices();


	out("Voices", voices.length)

	ss.say("Well it's all working")
	ss.say("Wow")
	ss.say("Let's all celebrate")
	ss.say({
		text: "With a nice cup of tea",
		boundary: (e) => console.log("******* IT IS A BOUNDARY", e)
	})
}
//)()



function out() {
	/*
	if (clearIt)
		document.getElementById(divId).innerHTML = '';
	*/
	str = [...arguments].join(' ');

	if (!str) return;

	var ndiv = `<div>${str}</div>`;

		// https://developer.mozilla.org/en-US/docs/Web/API/Element/insertAdjacentHTML

	let oDiv = document.getElementById('mainoutput');

	if (oDiv) {
		oDiv.insertAdjacentHTML('beforeend', ndiv);
	}
	else {
		console.log(r("Couldn't output to mainoutput"), str);
		couldNotOut.push(str);
	}

}


function qsa(query, el=document) {
	return [...el.querySelectorAll(query)];
}

function gid(id, el = document) {
    return el.getElementById(id);
}

function sleep(ms) {		// sleep(200).then(...)
	return new Promise(res => {
		setTimeout(res, ms)
	});
}

function docReady(fn) {
    // see if DOM is already available
    if (document.readyState === "complete" || document.readyState === "interactive") {
        // call on next available tick
        setTimeout(fn, 1);
    } else {
        document.addEventListener("DOMContentLoaded", fn);
    }
}

</script>